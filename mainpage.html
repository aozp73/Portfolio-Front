<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <style>
        body {
            padding-top: 88px;
        }
    </style>
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>    
    
    <header class="navbar navbar-custom navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">포트폴리오</a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto"> 
                    <li class="nav-item me-4">
                        <a class="nav-link" href="/resume.html">Resume</a>
                    </li>
                    <li class="nav-item me-4">
                        <a class="nav-link" href="/project.html">Project</a>
                    </li>
                    <li class="nav-item me-4">
                        <a class="nav-link" href="/skills.html">Skills</a>
                    </li>
                    <li class="nav-item me-5">
                        <a class="nav-link" href="/TechBlog.html">TechBlog</a>
                    </li>
                </ul>
                <button type="button" class="btn btn-primary mb-2 ms-2 edit-button" onclick="toggleEditMode()">편집모드</button>

            </div>
        </div>
    </header>        

    <div class="py-5" style="background-color: #F9F9F9" id="main-container">


        <div class="container ps-5" style="height:450px" id="content-1">
            <div class="row">
                <div class="col-5 me-5">
                    <img src="image/mainpage-sample.png" alt="Description of Image" class="img-fluid responsive-image">
                </div>
                <div class="col-5 pt-3">
                    <h2>새로운 것을 배우고, 기록하는 것을 좋아하는 개발자</h2><hr>
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                </div>
                <div class="col-2">
                </div>
            </div>
            <div class="edit-controls" style="display: none;">
                <div class="my-3 me-5 d-flex justify-content-end">  
                    <button type="button" class="btn btn-outline-secondary me-2" onclick="updateForm(event, 1)">수정하기</button>
                    <button type="button" class="btn btn-outline-danger me-5" onclick="deletePost()">삭제하기</button>
                </div>
            </div>
        </div>

        <div class="container pe-5" style="height:450px" id="content-2">
            <div class="row">
                <div class="col-1">
                </div>
                <div class="col-5 pt-3">
                    <h2>새로운 것을 배우고, 기록하는 것을 좋아하는 개발자</h2><hr>
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                </div>
                <div class="ms-5 col-5">
                    <img src="image/mainpage-sample.png" alt="Description of Image" class="img-fluid responsive-image">
                </div>
            </div>
            <div class="edit-controls" style="display: none;">
                <div class="my-3 me-1 d-flex justify-content-end">
                    <button type="button" class="btn btn-outline-secondary me-2" onclick="updateForm(event, 2)">수정하기</button>
                    <button type="button" class="btn btn-outline-danger me-5" onclick="deletePost()">삭제하기</button>
                </div>
            </div>
        </div>


        <div class="container ps-5" style="height:450px" id="content-3">
            <div class="row">
                <div class="col-5 me-5">
                    <img src="image/mainpage-sample.png" alt="Description of Image" class="img-fluid responsive-image">
                </div>
                <div class="col-5 pt-3">
                    <h2>새로운 것을 배우고, 기록하는 것을 좋아하는 개발자</h2><hr>
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                </div>
                <div class="col-2">
                </div>
            </div>
            <div class="edit-controls" style="display: none;">
                <div class="my-3 me-5 d-flex justify-content-end">  
                    <button type="button" class="btn btn-outline-secondary me-2" onclick="updateForm(event, 3)">수정하기</button>
                    <button type="button" class="btn btn-outline-danger me-5" onclick="deletePost()">삭제하기</button>
                </div>
            </div>
        </div>


        <div class="container pe-5" style="height:450px" id="content-4">
            <div class="row">
                <div class="col-1">
                </div>
                <div class="col-5 pt-3">
                    <h2>새로운 것을 배우고, 기록하는 것을 좋아하는 개발자</h2><hr>
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                    학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.
                </div>
                <div class="ms-5 col-5">
                    <img src="image/mainpage-sample.png" alt="Description of Image" class="img-fluid responsive-image">
                </div>
            </div>
            <div class="edit-controls" style="display: none;">
                <div class="my-3 me-1 d-flex justify-content-end">
                    <button type="button" class="btn btn-outline-secondary me-2" onclick="updateForm(event, 4)">수정하기</button>
                    <button type="button" class="btn btn-outline-danger me-5" onclick="deletePost()">삭제하기</button>
                </div>
            </div>
        </div>

        <!-- 새 글 쓰기 -->
        <div class="edit-controls" style="display: none;">
            <div class="container mt-5">

                <form id="postForm">
                    <div class="mb-3">
                        <label for="postTitle" class="form-label">제목</label>
                        <input type="text" class="form-control" id="postTitle-new" placeholder="제목을 입력하세요">
                    </div>
                    <div class="mb-3">
                        <label for="postContent" class="form-label">내용</label>
                        <textarea class="form-control" id="postContent-new" rows="5" placeholder="내용을 입력하세요"></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="postImage" class="form-label">사진 업로드</label>
                        <input type="file" id="fileInput-new">
                        <div id="imagePreview" class="mt-3"></div> 
                    </div>
                    <div class="my-3 d-flex justify-content-end">
                        <button type="button" class="btn btn-primary" onclick="addPost()">글 등록하기</button>
                    </div>
                </form>
            </div>
        </div>
         <!-- 새 글 쓰기 -->

    </div>


    <script>
        let modeCnt = 0
        window.addEventListener('scroll', function() {
            let navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) { 
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        // 편집 모드 (toggle)
        function toggleEditMode() {
            modeCnt += 1
            if (modeCnt >= 2) {
                location.reload();
            }

            const controls = document.querySelectorAll('.edit-controls');
            controls.forEach(control => {
                if (control.style.display === 'none') {
                    control.style.display = 'block';
                } else {
                    control.style.display = 'none';
                }
            });
        }
        
        function updateForm(event, container_number) {
            event.preventDefault();
            let section = document.getElementById('content-' + container_number);
                if (container_number % 2 === 0) {
                    section.innerHTML = `
                        <div class="row">
                            <div class="col-1">
                            </div>
                            <div class="col-5 pt-3">
                                <div class="mb-3">
                                    <input type="text" class="form-control" id="postTitle-${container_number}" placeholder="제목을 입력하세요" value="새로운 것을 배우고, 기록하는 것을 좋아하는 개발자">
                                </div>
                                <hr>
                                <div class="mb-3">
                                    <textarea class="form-control" id="postContent-${container_number}" rows="5" placeholder="내용을 입력하세요">학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.</textarea>
                                </div>
                            </div>
                            <div class="ms-5 col-5">
                                <div class="mb-2">
                                    <img src="image/mainpage-sample.png" alt="Description of Image" class="img-fluid responsive-image" id="imageToChange-${container_number}">
                                </div>
                                <input type="file" id="fileInput-${container_number}" onchange="checkImage(${container_number})">
                            </div>
                        </div>
                        <div class="edit-controls" style="display: none;">
                            <div class="my-3 me-1 d-flex justify-content-end">
                                <a href="#" class="btn btn-outline-secondary me-2">수정하기</a>
                                <a href="#" class="btn btn-outline-danger me-5">삭제하기</a>
                            </div>
                        </div>
                        <div class="my-3 d-flex justify-content-end">  
                            <button class="btn btn-outline-secondary" onclick="updateImage(${container_number})">수정완료</button>
                        </div>
                    `;

                } else {
                    
                    section.innerHTML = `
                        <div class="row">
                            <div class="col-5 me-5">
                                <div class="mb-2">
                                <img src="image/mainpage-sample.png" alt="Description of Image" class="img-fluid responsive-image" id="imageToChange-${container_number}">
                                </div>
                                <input type="file" id="fileInput-${container_number}" onchange="checkImage(${container_number})">
                            </div>
                            <div class="col-5 pt-3">
                                <div class="mb-3">
                                    <input type="text" class="form-control" id="postTitle-${container_number}" placeholder="제목을 입력하세요" value="새로운 것을 배우고, 기록하는 것을 좋아하는 개발자">
                                </div>
                                <hr>
                                <div class="mb-3">
                                    <textarea class="form-control" id="postContent-${container_number}" rows="5" placeholder="내용을 입력하세요">학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.학습한 내용을 기록하며, 프로젝트 진행간 기술 블로그 작성을 즐겨합니다.</textarea>
                                </div>
                            </div>
                            <div class="col-2">
                            </div>
                        </div>
                        <div class="my-3 me-5 d-flex justify-content-end">  
                            <button class="btn btn-outline-secondary" onclick="updateImage(${container_number})">수정완료</button>
                        </div>
                    `;
                }                
            }
        
        function deletePost(container_number) {


        }

        function addPost(){
            postTitle = $(`#postTitle-new`).val()
            postContent = $(`#postContent-new`).val()
            let input = document.getElementById(`fileInput-new`);
            
            readFileAsDataURL(input, function(dataURL) {
                let imgData = {
                    "image": dataURL
                };
                let jsonPayload = JSON.stringify(imgData);
                console.log(jsonPayload)    
            });


            // ajax 통신 이 후 추가 (PK값에 따라 사진 배치 다르게)
            inner = `

            `
        }
        
        function checkImage(container_number) {
            const fileInput = document.getElementById('fileInput-'+container_number);
            const imageToChange = document.getElementById('imageToChange-'+container_number);
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();
                // 이벤트 큐에 등록. CallBack 함수 작성
                reader.onload = function(e) {
                    imageToChange.src = e.target.result;
                }
                // 다 읽고 난 뒤, 위 CallBack 함수 작동
                reader.readAsDataURL(file);
            }
        }

        function updateImage(container_number){
            postPK = `${container_number}`
            postTitle = $(`#postTitle-${container_number}`).val()
            postContent = $(`#postContent-${container_number}`).val()

            let input = document.getElementById(`fileInput-${container_number}`);

            readFileAsDataURL(input, function(dataURL) {
                let imgData = {
                    "image": dataURL
                };
                let jsonPayload = JSON.stringify(imgData);
            });

            // ajax 통신 이 후, reload
        }

        function readFileAsDataURL(input, callback) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                
                reader.onload = function (e) {
                    callback(e.target.result);
                };
                
                reader.readAsDataURL(input.files[0]);
            }
        }


    </script>


        <hr class="bg-secondary mb-5 mt-0">

    </body>
    
</html>